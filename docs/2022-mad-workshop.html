<!doctype html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=10.0, user-scalable=yes">

	<title>Workshop: MLOps MAD 2022</title>

	<link rel="stylesheet" href="revealjs/reveal.js/dist/reset.css" />
    <link rel="stylesheet" href="revealjs/reveal.js/dist/reveal.css" />
    <link rel="stylesheet" href="revealjs/reveal.js/dist/theme/white.css" />

    <!-- Theme used for syntax highlighted code -->
	<!-- <link rel="stylesheet" href="revealjs/reveal.js/plugin/highlight/monokai.css"> -->
	<!-- <link rel="stylesheet" href="revealjs/reveal.js/plugin/highlight/zenburn.css"> -->
    <link rel="stylesheet" href="revealjs/highlight-js-github-theme.css" />
    <link rel="stylesheet" href="revealjs/styles.css" />

</head>

<body style="background-color: whitesmoke;">
	<div class="reveal">
		<div class="slides">

<!-- 
https://mad-summit.de/fundamentals/mlops-wo-machine-learning-auf-softwareentwicklung-trifft/

MLOps – wo Machine Learning auf Softwareentwicklung trifft

Machine Learning kann sowohl mit dem Ziel des Erkenntnisgewinns als auch mit dem Ziel einer Vorhersage betrieben werden.
Während Erkenntnisgewinne eher im Bereich Data Science oder Statistik angesiedelt sind, kann eine Vorhersage auch wie
ein klassisches Stück Business-Logik eingesetzt werden. In diesem Bereich der Vorhersagen gibt es viele Überschneidungen
mit klassischer Softwareentwicklung und der DevOps-Bewegung, allerdings auch einige Besonderheiten.

In diesem Workshop sehen wir uns unabhängig von der Programmiersprache den Bereich des Machine Learnings durch die
Brille der Softwareentwicklung an.
-->

<!-- <section data-markdown class="todo">
	<textarea data-template>
### Erkenntnisse nach Fortiss Hotspot MLOps

1. Story klarer kriegen
  * Drift detektieren bevor man ground truth hat
  * ODER
  * Detektieren wann man neue Ground Truth sammeln und neu trainieren sollte

2. Deployment Strategien klären
  1. Deploy Permanently VS
  2. Deploy when you need to
  
3. In Iterationen vorgehen
  1. Erst einmal die Story komplett durchgehen
  1. Dann Details
  </textarea>
</section>
 -->

<!-- <section data-markdown class="todo">
	<textarea data-template>
### Bias / Fairness

* Über der Oberfläche
  * Widersprüchliche Metriken
  * Accuracy-Fairness-Tradeoff
  * Bias bereits in Trainingsdaten
  * Wer entscheidet was Fair ist?
  * Gruppenbasierte vs individuelle Fairness
* Unter der Oberfläche
  * Proxy Variablen (nicht Einkommen oder Alter, sondern PLZ)
  * Data- oder Concept-Drift
  * Ist eine algorithmische Lösung möglich und angemessen
  * Einspruch gegen algorithmische Entscheidung möglich?
  * Keine Ground-Truth in Production
  * Datenschutz vs Fairness
  * Nützt Fairness dem Geschäft?
  * Beim manuellem Labelling können Labels Weltanschauung in Bias der Annotierenden enthalten
  * Zementierung bestehender Machtstrukturen
  * Unmöglichkeit eindeutiger Kategorisierung (z.B. Geschlecht, sexuelle Orientierung)
</textarea>
</section>

---

Resilient Machine Learning
- Unwanted Bias
- Adversarial Attacks
- Out-of-distribution Robustness
  - http://www.gatsby.ucl.ac.uk/~balaji/balaji-odsc-talk.pdf
- Reliable measure of certainty of prediction  
  - http://www.gatsby.ucl.ac.uk/~balaji/balaji-odsc-talk.pdf
- Drift
- Stability
  - https://djcordhose.github.io/ai/2019_m3_embeddings.html#/32
  - https://djcordhose.github.io/ai/2019_m3_embeddings.html#/36
- Fallbacks / Ensembles
  - https://danshiebler.com/2022-07-04-resilient-machine-learning/


---
M3
https://www.m3-konferenz.de/cfp.php

Resilientes Machine Learning

Resilienz ist die Fähigkeit der Anpassung an schwierige oder unerwartete Situationen.
Eine solche Widerstandskraft kann es bei Menschen geben oder eben auch in Softwaresystemen.
Bei klassischen Softwaresystemen betrifft Resilienz häufig nur die Ausfallsicherheit.
Mit der Nutzung von Machine Learning innerhalb der Systeme kommen viele weitere Aspekte hinzu. Eine Besonderheit ist
hier eine komplexe Geschäftslogik, die als ein abstraktes Artefakt vorliegt. Diese unterliegt nicht mehr vollständig der
Kontrolle der Entwickler.
Als Konsequenz müssen wir uns mit Phänomenen wie Adversarial Attacks, Out-of-Distribution Robustness und Drift
auseinandersetzen.
Die Stabilität des Modells muss hier bei Neutraining und Nachtraining gewährleistet werden.
Maßnahmen umfassen das Monitoring von Machine Learning-Modellen, die Erkennung von Ausreißern und den Betrieb mit
Fallbacks und/oder mehreren Modellen als Ensemble.
Auch eine geschickte Auswahl des Modells für die Produktion kann schon viel bewirken.
In diesem Talk erläutere ich die genannten Phänomene und gehe auf die jeweils passenden Maßnahmen ein.

Kurze Version


Resilienz ist die Fähigkeit der Anpassung an schwierige oder unerwartete Situationen.

Im Bereich des Machine Learnings müssen wir uns dabei mit Phänomenen wie Adversarial Attacks, Out-of-Distribution Robustness und Drift auseinandersetzen.
Die Stabilität des Modells muss hier bei Neutraining und Nachtraining gewährleistet werden.
Maßnahmen umfassen das Monitoring von Machine Learning-Modellen, die Erkennung von Ausreißern und den Betrieb mit Fallbacks und/oder mehreren Modellen als Ensemble.
Auch eine geschickte Auswahl des Modells für die Produktion kann schon viel bewirken.
In diesem Talk erläutere ich die genannten Phänomene und gehe auf die jeweils passenden Maßnahmen ein.

Vorkenntnisse

Grundverständnis vom Training von Machine Learning Modellen

Lernziele

Ein Einblick in die Welt des Machine Learnings in Produktion und was man beachten muss, Nachts gut schlafen zu können.


---
Booster mit Hanna

Gamifying MLOps - Experiencing Machine Learning Operations

Getting machine learning into production and keeping it there is the topic of Machine Learning Operations (MLOps). In
order to get a feeling for this, we will let you play through the phases of a machine learning project that you have to
get into production and keep there for as long as possible to profit from it.
Along the way, events occur that influence the setting and show whether you made the right choices or not. This way you
can experience what it feels like to have a machine learning model in production instead of only talking about it.
We will bring a couple of game sets, so even though the number of participants will be limited, there will be a good
amount of people who can join in.
You will need no prior knowledge of machine learning and you don't even have to be a technical person to participate.


Bio Hanna: 

Hanna started her career as a researcher in linguistics but then decided to pursue another Master's degree in
Computer Science and to work as a developer. She sees Machine Learning as a great way to combine the thinking part of
her first career choice with the acting part of her second career choice.

Bio Olli:

Oliver is a software developer and architect from Hamburg, Germany. He has been developing software with different
approaches and programming languages for more than 3 decades. Lately, he has been focusing on Machine Learning and its
interactions with humans.

Any equipment needed?

We will bring the game sets, but we need 5 tables and 5 chairs around each table. 

---

ODSC Europe / Pydata Berlin

Mischung als Resilient ML wie bei M3 und dem was ich mit Hanna erfolglos bei der MLConference eingereicht habe


"Fit a model on a given dataset sampled from a distribution that represents our problem" could be a casual way of describing the classic idea of machine learning.
 
This, however, does not reflect the challenges of many modern machine learning projects. Data does not simply exist and the sample people are working on often is not static, but rather gets generated incrementally in smaller batches. Also, the distribution the data is sampled from can change with the domain it comes from.

In this talk we will address the following questions:
- Workflow: What kind of workflow reflects a more incremental take on machine learning?
- Training for Production: How can we anticipate if our model works well in production and when to retrain?
- Explainability: How can we find out how our model works to check for bias and analysis of degradation?
- Unwanted Bias: Data sampled in the past is used to predict the future. How can we find out if our model has bias that is (no longer) wanted?
- Testing: What is a proper way of testing a model to find regressions from previous cycles?
- Monitoring: How do we detect when our model actually degrades in production and how do we react?

Material 
- OK, debates about the necessity or "priors" (or lack thereof) in learning systems are pointless.
Here are some basic facts that all ML theorists and most ML practitioners understand, but a number of folks-with-an-agenda don't seem to grasp.
Thread.
1/
(https://twitter.com/ylecun/status/1591463668612730880?t=eyUG-2osacHHE3fDMDgO3g&s=03) 
  - 


-->

<!-- <section data-markdown class="preparation">
	<textarea data-template>
### Vorbereitung

* Stift einsatzbereit (geladen)
* Probelauf Drift Detection
* Installation einmal platt machen: `docker compose down --volumes --rmi all`
* Und wieder hoch fahren dabei alles neu bauen und alle images neu ziehen: `docker compose up --build`
</textarea>
</section>

<section data-markdown class="todo">
	<textarea data-template>
### Stichworte von ODSC

* Warum selten Trainieren
  - different Model, unexpected traits
  - manual inspection is typically necessary
  - Metrics having thresholds will not be good enough when images or texts are the input 
  - Stability: an ML model is a complex system, people need to make themselves familiar with it. Would you like to have a new character trait in your colleagues every day?
</textarea>
</section>

<section data-markdown class="todo">
	<textarea data-template>
###  Uncertainty and Out-of-distribution Robustness in Deep Learning

http://www.gatsby.ucl.ac.uk/~balaji/balaji-odsc-talk.pdf
http://www.gatsby.ucl.ac.uk/~balaji/balaji-siam-uq-2022-invited-talk.pdf
</textarea>
</section>
 -->
<section data-markdown style="font-size: x-large;">
  <textarea data-template>
## Spielvorbereitung

### Ziel
* Im Spiel: Möglichst viel Geld machen, und nicht aus dem Geschäft fliegen
* Für uns: Teilnehmer erleben MLOps, anstatt sich nur Gesabbel anzuhören, MLOps wird erlebbar

### Material Pro Team
1. Ein Würfel, auch möglich: https://onlinewuerfel.de/
1. Einen Satz von Zetteln
   <!-- 1. Überblick: <a href='arbeitsblaetter/blatt1.pdf'>arbeitsblaetter/blatt1.pdf</a> -->
   1. Entscheidung welcher ML Ansatz: <a href='arbeitsblaetter/ML_Steckbriefe_v1.pdf'>arbeitsblaetter/ML_Steckbriefe_v1.pdf</a>,
   <a href='arbeitsblaetter/ML_Steckbriefe_v1.docx'>arbeitsblaetter/ML_Steckbriefe_v1.docx</a>
   1. Spielregeln / Kosten / Gewinn / Ereignisse: <a href='arbeitsblaetter/Spielregeln_v1.pdf'>arbeitsblaetter/Spielregeln_v1.pdf</a>,
   <a href='arbeitsblaetter/Spielregeln_v1.docx'>arbeitsblaetter/Spielregeln_v1.docx</a>
   1. Spiel-Tabelle: <a href='arbeitsblaetter/Kalkulationsblatt_v1.pdf'>arbeitsblaetter/Kalkulationsblatt_v1.pdf</a>,
   <a href='arbeitsblaetter/Kalkulationsblatt_v1.docx'>arbeitsblaetter/Kalkulationsblatt_v1.docx</a>
  </textarea>
</section>

<!-- <section data-markdown class="todo">
  <textarea data-template>
### 5 Runden spielen

* Gewinn: Accuracy minus Baseline (raten) mal 15 pro Runde aufgerundet, z.B.
  * (0,85 - 0,3) * 15 = _9_
  * (0,6 - 0,3) * 15 = _4_

* Kosten: Ressourcen
  1. DL: 4 Geld pro Runde
  1. DT: 2 Geld pro Runde
  1. KNN: 4 Geld pro Runde
  1. Regelsystem: 2 Geld pro Runde
  
* Kosten: Aktionen
  * Daten beschaffen  
    * initial: 10 Geld
    * später: 5 Geld
  * Passenden ML Ansatz designen: 5 Geld
  * Extrakosten Deep Learning Ansatz designen (jede Iteration braucht länger und bessere Hardware): 5 Geld 
  * Modell nachtrainieren: 2 Geld
  </textarea>
</section>


  <section data-markdown class="todo">
    <textarea data-template>
### Ereignisse

Normaler Würfel, 6 Seiten

1. (1) Last Verändert sich
  1. (1-3) Last steigt: Ressourcen werden teuer, mal 2, max 10
  1. (4-6) Last sinkt: Ressourcen werden billiger, durch 2, min 1
1. (2-3) Übles Ereignis
  * Noch einmal würfeln
  * Je nach Ergebnis einen der 4 Buzzer abfeuern
  1. (1-2) Kunden fordern Erklärung
     * Notabschaltung und Fallback auf Regelsystem wenn Erklärbarkeit nicht gegeben ist
  1. (3-4) Investigativer Journalismus: Bias / Alterdiskriminierung
     * Notabschaltung und Fallback auf (Not-)Regelsystem wenn Alter für Vorhersage zwingend notwendig ist
  1. (5) Adversarial Attack: Angreifer versuchen die Vorhersage zu manipulieren
     * Verständlichkeit / Erklärbarkeit macht den Angriff leichter, aber du bemerkst den Schaden erst spät, da kein Drift vorliegt, in diesem Fall gehst du pleite
  1. (6) Hackerangriff
     * Du bist aus dem Geschäft wenn du Kundendaten in Produktion hast
1. (4-5) Die Welt ändert sich, Drift setzt ein
  * Du musst neue Daten beschaffen: x Kosten
  * Falls Regelsystem, keine weiteren Kosten, da direkte Anpassung
  * Nochmal würfeln
    1. (1-2) Das Modell performant auf den neuen Daten immer noch super, keine weiteren Aktionen und Kosten erforderlich
    1. (3-4) Es muss mit neuen Daten trainiert werden, das langt aber: 
       * doppelte Kosten wenn Modell nicht stabil
    1. (5) Dramatischer Absturz der Performance: Notabschaltung und zurück zu Regelsystem, Accuracy dementsprechend dauerhaft runter
    1. (6) Neue Modell-Architektur mit vertretbarem Aufwand stellt ursprüngliche Performance wieder her: Kosten für Passenden ML Ansatz designen (auch bei DL nur einfach)
1. (6) Es läuft alles rund
  </textarea>
  </section>
   -->
			<section data-markdown>
				<textarea data-template>
# MLOps – wo Machine Learning auf Softwareentwicklung trifft

MAD 2022, https://mad-summit.de/fundamentals/mlops-wo-machine-learning-auf-softwareentwicklung-trifft/

Hanna Lüschow / hanna.lueschow@openknowledge.de

Oliver Zeigermann / oliver.zeigermann@openknowledge.de

Folien: https://bit.ly/mad-2022-mlops
    </textarea>
			</section>

<section data-markdown>
  <textarea data-template>
### Wer ist Hanna

<img src='img/Hanna-Lueschow-6.jpg'>

<p>
<a target="_blank" href="mailto:hanna.lueschow@openknowledge.de">Hanna Lüschow</a>:
Dev@OPEN KNOWLEDGE
</p>    
</textarea>
</section>

<section data-markdown>
  <textarea data-template>
### Wer ist Olli

<img src='img/olli-opa.jpeg'>

<p>
<a target="_blank" href="mailto:oliver.zeigermann@openknowledge.de">Oliver Zeigermann</a>:
ML Architekt@OPEN KNOWLEDGE
</p>    
</textarea>
</section>

<section data-markdown>
	<textarea data-template>
### Gruppen

1. Tut euch mit euren Nachbarn in Gruppen von ca. 5 Menschen zusammen
1. Stellt euch kurz einander vor, z.B.
  * Was macht ihr?
  * Was wisst ihr schon?
  * Warum seid ihr hier?
</textarea>
</section>

<section data-markdown>
	<textarea data-template>
## Ablauf

### Teil I: Vorbereitung
1. Story, Überblick Vogelperspektive
1. Anwendung und Daten
1. Exkursion: ML Ansätze
1. Spielvorbereitung: ML Ansatz auswählen

### Teil II: Betrieb
1. Exkursion: Produktion, Drift, Statistik
1. Spielverlauf: Model in Produktion betreiben
1. Bericht / Auswertung
</textarea>
</section>

<section data-markdown>
  <textarea data-template>
# Teil I

Vorbereitung
  </textarea>
</section>

<section data-markdown>
	<textarea data-template>
## Story, Überblick Vogelperspektive

### <a href='arbeitsblaetter/blatt1.pdf'>Blatt I</a>

<!-- <a href="https://miro.com/app/board/uXjVPPE7mCg=/?share_link_id=235653251419">Story, Überblick Vogelperspektive</a> -->
</textarea>
</section>

<section data-markdown>
	<textarea data-template>
## Anwendung und Daten

<a href="./2022-mad-exkursion-fallbeispiel.html">Anwendung und Daten</a>
</textarea>
</section>

<section data-markdown>
	<textarea data-template>
## Exkursion: ML Ansätze

<a href="./2022-mad-exkursion-ml-ansaetze.html">Exkursion: ML Ansätze</a>
</textarea>
</section>

<section data-markdown>
	<textarea data-template>
## Spielvorbereitung: ML Ansatz auswählen

### <a href='arbeitsblaetter/ML_Steckbriefe_v1.pdf'>Blatt II - Welches Modell bringst du in Produktion?</a>

Entscheide dich anhand der gezeigten Kriterien

</textarea>
</section>

<section data-markdown>
<textarea data-template>
### Bericht der Gruppen

* Wir haben unterschiedliche Modelle mit unterschiedlichen Eigenschaften
* Welcher Ansatz passt am ehesten?
* Welche Kompromisse gehst du ein?
</textarea>
</section>

<section data-markdown>
  <textarea data-template>
# Teil II

Betrieb
  </textarea>
</section>


<section data-markdown>
  <textarea data-template>
### Wie kann man ML in Produktion bringen?

<img src="img/Typical_Deployment_of_a_Machine_Learning_Service.PNG">
</textarea>
</section>


<section data-markdown>
	<textarea data-template>
## Exkursion: Produktion, Drift, Statistik

<a href="./2022-mad-exkursion-drift.html">Exkursion: Produktion, Drift, Statistik</a>
</textarea>
</section>


<section data-markdown>
	<textarea data-template>
## Spielverlauf: Model in Produktion betreiben

### <a href='arbeitsblaetter/Spielregeln_v1.pdf'>Blatt III: Spielregeln, Kosten/Gewinn, Ereignisse</a>

</textarea>
</section>

<section data-markdown style="font-size: large;">
  <textarea data-template>
### Exemplarischer Spielverlauf

<div class="container">
  <div class="col">

#### Hanna: Regelsystem

* Start: _25 Geld_
  * Kosten: 10 Geld, Daten beschaffen
  * Gewinn / Runde: 4
  * Betriebs-Kosten / Runde: 1 
* Runde 1: _15 Geld_
  * Ereignis: Drift, neue Daten beschaffen, einmalig 5 Geld
  * Gewinn / Runde: 4
  * Betriebs-Kosten / Runde: 1
* Runde 2: 15 - 5 + 4 - 1 = _13 Geld_
  * Ereignis: alles läuft rund
  * Gewinn / Runde: 4
  * Betriebs-Kosten / Runde: 1
* Runde 3: 13 + 4 - 1 = _16 Geld_

  </div>
  <div class="col">

#### Olli: Deep Learning

* Start: _25 Geld_
  * Kosten: 10 Geld Daten beschaffen, 5 Geld ML Ansatz, 5 Geld DL Ansatz
  * Gewinn / Runde: 9
  * Betriebs-Kosten / Runde: 2 
* Runde 1: _5 Geld_
  * Ereignis: Last sinkt, Kosten sinken
  * Gewinn / Runde: 9
  * Betriebs-Kosten / Runde: 1
* Runde 2: 5 + 9 - 1 = _13 Geld_
  * Ereignis: Drift, neue Daten beschaffen und trainieren, einmalig 7 Geld
  * Gewinn / Runde: 9
  * Betriebs-Kosten / Runde: 1
* Runde 3: 13 + 9 - 1 - 7 = _14 Geld_




  </div>

</div>
<!-- * Hanna: 25
  * - 10 Geld, Daten beschaffen
  * Start:
    * Geld 15
    * Gewinn / Runde: 4
    * Kosten: 1 
  * Runde 1: Drift
    * Geld: 13
    * Gewinn / Runde: 4
    * Kosten: 1
  * Runde 2: Drift
    * Geld: 13 + 4 - 1 - 5 = 11
    * Gewinn / Runde: 4
    * Kosten: 1
  * Runde 3: Nix
    * Geld: 11 + 4 - 1 = 14
    * Gewinn / Runde: 4
    * Kosten: 1
  * Runde 4: Last steigt
    * Geld: 14 + 4 - 1 = 17
    * Gewinn / Runde: 4
    * Kosten: 2
  * Runde 5: Nix
    * Geld: 17 + 4 - 2 = 19
    * Gewinn / Runde: 4
    * Kosten: 2

* Olli: 25
  * - 10 Geld, Daten beschaffen
  * - 5 Geld, ML Ansatz
  * - 5 Geld, DL Ansatz
  * Start:
    * Geld 5
    * Gewinn / Runde: 9
    * Kosten: 2
  * Runde 1: Last sinkt
    * Geld: 12
    * Gewinn / Runde: 9
    * Kosten: 1
  * Runde 2: Drift
    * 12 + 9 - 1 - 7 = 13
    * Gewinn / Runde: 9
    * Kosten: 1
  * Runde 3: Last steigt
    * Geld: 13 + 9 - 1 = 21
    * Gewinn / Runde: 9
    * Kosten: 2
  * Runde 4: Last sinkt
    * Geld: 21 + 9 - 2 = 28
    * Gewinn / Runde: 9
    * Kosten: 1
  * Runde 5: Nix
    * Geld: 28 + 9 - 1 = 36
    * Gewinn / Runde: 9
    * Kosten: 1
 -->
</textarea>
</section>


<section data-markdown>
  <textarea data-template>
### 5 Runden spielen

### <a href='arbeitsblaetter/Kalkulationsblatt_v1.pdf'>Blatt IV: Spiel-Tabelle</a>

Würfel, auch online möglich: https://onlinewuerfel.de/
</textarea>
</section>

<section data-markdown class="fragments">
<textarea data-template>
### Bericht der Gruppen

1. Wer hat mit welchem Modell gewonnen?
1. Welche üblen Ergebnisse sind eingetreten?
1. Wart ihr zufrieden mit der Auswahl des Modells?
1. Habt ihr Gewinn gemacht?
</textarea>
</section>


<section data-markdown class="fragments">
<textarea data-template>
### Zusammenfassung

1. Machine Learning Projekte können in Phasen gedacht werden
1. In der ersten Phase macht man möglichst schnelle Experimente
1. Sollte sich eine Idee als tragfähig erweisen, professionalisiert man die Idee
1. Dies ist Voraussetzung und Grundlage für Produktion
1. In Produktion ergeben sich besondere Herausforderung im Bereich Monitoring
1. Typischerweise müssen Machine Learning Systeme regelmäßig nachtrainiert und gepflegt werden
</textarea>
</section>

		<section data-markdown>
			<textarea data-template>
# Vielen Dank

MLOps – wo Machine Learning auf Softwareentwicklung trifft

Bleibt gern im Kontakt

Hanna Lüschow / hanna.lueschow@openknowledge.de

Oliver Zeigermann / oliver.zeigermann@openknowledge.de
https://www.linkedin.com/in/oliver-zeigermann-34989773/
https://twitter.com/DJCordhose

</textarea>
		</section>

		</div>
	</div>
	<script src="revealjs/reveal.js/dist/reveal.js"></script>
	<script src="revealjs/reveal.js/plugin/notes/notes.js"></script>
	<script src="revealjs/reveal.js/plugin/markdown/markdown.js"></script>
	<script src="revealjs/reveal.js/plugin/highlight/highlight.js"></script>
	<script src="revealjs/config.js"></script>


</body>

</html>